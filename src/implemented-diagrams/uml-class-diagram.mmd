classDiagram
    %% Core Classes
    class ParkingLot {
        -_instance: ParkingLot
        -levels: List[ParkingLotLevel]
        -observers: List[ParkingLotObserver]
        +get_instance()
        +create_parking_lot(data: ParkingLotData)
        +park(reg, make, model, color, is_electric, is_motorcycle, lot_name, level)
        +leave(slot_number)
        +notify_observers(message)
        +get_lot_names()
        +get_levels_for_lot(lot_name)
        +get_vehicles_in_lot(lot_name, level)
        +get_slot_by_registration(reg)
        +get_vehicle(slot_number)
        +get_slots_by_color(color)
        +get_slots_by_make(make)
        +get_slots_by_model(model)
        -Dict[str, Dict[int, Dict[int, Vehicle]]] vehicles
        +add_observer()
        +remove_observer()
        +notify_observers()
        +park_vehicle()
        +remove_vehicle()
        +search_vehicles()
    }
    
    class ParkingLotLevel {
        -level: int
        -name: str
        -regular_slots: List[ParkingSlot]
        -ev_slots: List[ParkingSlot]
        +get_level()
        +get_slots()
        +set_name(name)
        +add_regular_slot(slot)
        +add_ev_slot(slot)
    }
    
    class ParkingSlot {
        -slot_type: str
        -vehicle: Vehicle
        +is_empty()
        +park(vehicle)
        +leave()
        +get_vehicle()
    }
    
    %% Observer Pattern
    class ParkingLotObserver {
        <<interface>>
        +on_parking_lot_updated()
    }
    
    class ParkingLotUI {
        -UIStateManager state_manager
        -TreeViewManager tree_manager
        -MessageManager message_manager
        -ValidationManager validation_manager
        -ParkingManager parking_manager
        -parking_lot: ParkingLot
        -park_lot_value: StringVar
        -park_level_value: StringVar
        +main_window: tk.Tk
        +create_widgets()
        +_handle_park()
        +_handle_remove()
        +_handle_search()
        +_update_park_lot_names()
        +_update_park_levels()
    }
    
    class UIStateManager {
        +lot_name_value: tk.StringVar
        +parking_level_value: tk.StringVar
        +regular_slots_value: tk.StringVar
        +electric_vehicle_slots_value: tk.StringVar
        +registration_number_value: tk.StringVar
        +vehicle_manufacturer_value: tk.StringVar
        +vehicle_model_value: tk.StringVar
        +vehicle_color_value: tk.StringVar
        +vehicle_type_value: tk.StringVar
        +is_electric_value: tk.BooleanVar
        +park_lot_value: tk.StringVar
        +park_level_value: tk.StringVar
        +search_registration_number_value: tk.StringVar
        +search_type_value: tk.StringVar
        +details_filter_value: tk.StringVar
    }
    
    class TreeViewManager {
        +results_tree: ttk.Treeview
        +details_tree: ttk.Treeview
        +update_results()
        +update_details()
        +clear_results()
        +clear_details()
    }
    
    class MessageManager {
        +message_area: tk.Text
        +show_error()
        +show_info()
        +show_success()
        +clear_messages()
    }
    
    class ValidationManager {
        +validate_parking_input()
        +validate_search_input()
        +validate_lot_creation()
    }
    
    class ParkingManager {
        -ParkingLot parking_lot
        +create_lot()
        +park_vehicle()
        +remove_vehicle()
        +search_vehicles()
        +get_lot_names()
        +get_vehicles_in_lot()
    }
    
    %% Factory Pattern
    class VehicleFactory {
        +create_car(reg, make, model, color)
        +create_truck(reg, make, model, color)
        +create_motorcycle(reg, make, model, color)
        +create_bus(reg, make, model, color)
        +create_electric_car(reg, make, model, color)
        +create_electric_motorcycle(reg, make, model, color)
    }
    
    %% Data Models
    class VehicleData {
        +registration: str
        +make: str
        +model: str
        +color: str
        +is_electric: bool
        +is_motorcycle: bool
    }
    
    class ParkingLotData {
        +name: str
        +level: int
        +regular_slots: int
        +ev_slots: int
    }
    
    %% Relationships
    ParkingLotObserver <|.. ParkingLotUI
    
    ParkingLot o-- ParkingLotLevel
    ParkingLot o-- ParkingLotObserver
    ParkingLotLevel o-- ParkingSlot
    
    ParkingLot ..> VehicleFactory : uses
    ParkingLot ..> VehicleData : uses
    ParkingLot ..> ParkingLotData : uses
    
    ParkingLotUI --> UIStateManager
    ParkingLotUI --> TreeViewManager
    ParkingLotUI --> MessageManager
    ParkingLotUI --> ValidationManager
    ParkingLotUI --> ParkingManager
    ParkingManager --> ParkingLot
    ParkingLot --> Vehicle
    
    Vehicle <|-- RegularVehicle
    Vehicle <|-- ElectricVehicle
    
    ParkingLotData --> ParkingLevelData
    ParkingLevelData --> ParkingSlotData 