sequenceDiagram
    participant Customer
    participant WebPortal
    participant API as API Gateway
    participant ParkingOps as Parking Operations
    participant Reservations
    participant EVCharging
    participant Billing
    participant Incident
    participant Analytics
    participant Admin
    participant Vehicle

    Customer->>WebPortal: Start session / login
    WebPortal->>API: Authenticate, load dashboard
    API->>ParkingOps: Get lot status
    API->>Reservations: Get reservation status
    API->>EVCharging: Get charger status
    API->>Billing: Get outstanding bills
    API->>Analytics: Get usage reports

    Customer->>WebPortal: Make reservation
    WebPortal->>API: Reserve slot
    API->>Reservations: Create reservation
    Reservations->>Billing: Calculate reservation fee
    Billing-->>Reservations: Fee details
    Reservations-->>API: Reservation confirmed
    API-->>WebPortal: Show confirmation

    Customer->>WebPortal: Enter parking lot
    WebPortal->>API: Entry event
    API->>ParkingOps: Register visit
    ParkingOps->>Reservations: Check reservation
    Reservations-->>ParkingOps: Reservation match
    ParkingOps->>Billing: Start billing session
    ParkingOps-->>API: Visit active
    API-->>WebPortal: Show slot assignment

    Customer->>WebPortal: Start EV charging
    WebPortal->>API: Request charging
    API->>EVCharging: Start session
    EVCharging->>ParkingOps: Link to visit
    EVCharging->>Billing: Start charging bill
    EVCharging-->>API: Charging started
    API-->>WebPortal: Show charging status

    Customer->>WebPortal: Exit lot
    WebPortal->>API: Exit event
    API->>ParkingOps: End visit
    ParkingOps->>Billing: Finalize bill
    Billing-->>API: Bill ready
    API-->>WebPortal: Show payment due

    Customer->>WebPortal: Pay bill
    WebPortal->>API: Payment
    API->>Billing: Process payment
    Billing-->>API: Payment confirmed
    API-->>WebPortal: Show receipt

    Note over Customer,API: This sequence covers reservation, entry, charging, exit, and payment for a typical user journey.
