stateDiagram-v2
    [*] --> Idle : System ready
    Idle --> ReservationActive : Reservation made
    ReservationActive --> VisitActive : Vehicle enters, visit started
    VisitActive --> ChargingActive : EV charging started
    ChargingActive --> ChargingComplete : Charging finished
    ChargingComplete --> VisitActive : Charging ends, visit continues
    VisitActive --> PaymentPending : Vehicle exits, bill generated
    PaymentPending --> Paid : Payment received
    PaymentPending --> Overdue : Payment missed
    Overdue --> Paid : Late payment
    Paid --> [*]
    VisitActive --> IncidentReported : Incident occurs
    IncidentReported --> VisitActive : Incident resolved
    ReservationActive --> Cancelled : Reservation cancelled
    Cancelled --> [*]
    ReservationActive --> Expired : Reservation not fulfilled
    Expired --> [*]
    ChargingActive --> Faulted : Charger/vehicle fault
    Faulted --> VisitActive : Fault resolved
    Faulted --> [*]
    note right of VisitActive
        Visit may include charging, incidents,
        and transitions to payment or exit
    end note
    note right of ReservationActive
        Reservation may be cancelled or expire
    end note
    note right of ChargingActive
        Charging may complete, fault, or be stopped
    end note
